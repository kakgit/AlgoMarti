	
<script src="/js/hslib.js" type="text/javascript"></script>
<!-- <script src="/js/demo.js" type="text/javascript"></script>
<script src="/js/neo.js" type="text/javascript"></script> -->

<div id="main" class="container-xxl">
    <div class="page-heading">
        <div class="row">
            <div class="col-4">
                <h3>Kotak Neo - Live Trader</h3>
            </div>
            <div class="col-4 text-center">
                <span class="badge bg-warning" id="spnGenMsg">Hi, Welcome</span>
            </div>
            <div class="col-4" style="text-align: right;">
                <a href="javascript: void(null);" class="btn btn-outline-primary" onclick="fnShowSettingsMdl();"><i class="fa fa-cogs" aria-hidden="true" style="color: orangered;"></i> Kotak Settings</a>
            </div>
        </div>
    </div>
    <div class="page-content">
        <section class="row">
            <div class="col-12 col-lg-12">
                <div class="row" style="text-align: center;">
                    <div class="col-6 col-lg-3 col-md-6">
                        <button class="badge bg-danger" onclick="fnShowKotakTraderLoginMdl(this);" id="btnTraderStatus">TRADER - Disconnected</button>
                    </div>
                    <div class="col-6 col-lg-3 col-md-6">
                        <button class="badge bg-danger" onclick="fnToggleAutoTrader();" id="btnAutoTraderStatus">Auto Trader - OFF</button>
                    </div>
                    <div class="col-6 col-lg-3 col-md-6">
                        <button class="badge bg-warning" onclick="//fnToggleRealTrade();" id="btnRealTradeStatus">Paper Trade - ON</button>
                    </div>
                    <div class="col-6 col-lg-3 col-md-6">
                        <button class="badge bg-success" onclick="fnPositionStatus()" id="btnPositionStatus">No Open Position</button>
                    </div>
                    <div class="col-12">&nbsp;</div>
                </div>
                <div class="row">
                    <div class="col-12 col-lg-12">
                        <div class="card">
                            <div class="card-header">
                                <div class="row">
                                    <div class="col-3">
                                        <h4>Manual Trader</h4>
                                    </div>
                                    <div class="col-2">
                                        <div class="form-check form-switch fs-6" style="white-space: nowrap;">
                                            <input class="form-check-input  me-0" type="checkbox" style="cursor: pointer" id="swtMartingale" name="swtMartingale" onchange="fnChangeMarti();" />
                                            <label for="swtMartingale" style="cursor:pointer;">Martingale</label>
                                        </div>
                                    </div>
                                    <div class="col-2">
                                        <form name="frmSide">
                                            <div class="tw-toggle" style="white-space: nowrap;">
                                                <input id="txtBN1" type="radio" name="rdoTradeSide" value="false" onclick="fnTradeSide();" />
                                                <label class="toggle toggle-yes" for="txtBN1"><i class="fa fa-arrow-down"></i></label>
                                                <input id="txtBN2" checked type="radio" name="rdoTradeSide" value="-1" onclick="fnTradeSide();" />
                                                <label class="toggle toggle-yes" for="txtBN2"><i class="fa fa-minus"></i></label>
                                                <input id="txtBN3" type="radio" name="rdoTradeSide" value="true" onclick="fnTradeSide();" />
                                                <label class="toggle toggle-yes" for="txtBN3"><i class="fa fa-arrow-up"></i></label>
                                                <span></span>
                                                <label for="TradeSide">Side</label>
                                            </div>
                                        </form>
                                    </div>
                                    <div class="col-2" style="text-align: right;">Start With </div>
                                    <div class="col-1"><input type="text" class="form-control" min="1" value="1" maxlength="3" id="txtStartLotNos" onchange="fnChangeKotakStartLotNos(this);" /></div>
                                    <div class="col-1"> Qty</div>
                                    <div class="col-1" style="text-align: right;">
                                        <a data-bs-toggle="collapse" href="#divTraderClps" role="button" aria-expanded="true" aria-controls="divTraderClps">
                                            <i class="fa fa-caret-square-o-down" aria-hidden="true" style="color: orangered;"></i>
                                        </a>
                                    </div>                                    
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="collapse show" id="divTraderClps">
                                    <div class="container-fluid">
                                        <div class="row">
                                            <div class="col-6 col-lg-3 col-md-6">
                                                To Trade Strike
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                Symbols List
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                Expiry
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                Current Rate
                                            </div>

                                            <div class="col-6 col-lg-3 col-md-6">
                                                <select id="ddlOptionStrike" onchange="fnChangeOptionStrike(this);" class="form-select">
                                                    <option value="-10">-10 ITM</option>
                                                    <option value="-9">-9 ITM</option>
                                                    <option value="-8">-8 ITM</option>
                                                    <option value="-7">-7 ITM</option>
                                                    <option value="-6">-6 ITM</option>
                                                    <option value="-5">-5 ITM</option>
                                                    <option value="-4">-4 ITM</option>
                                                    <option value="-3">-3 ITM</option>
                                                    <option value="-2">-2 ITM</option>
                                                    <option value="-1">-1 ITM</option>
                                                    <option value="0" selected="true">ATM</option>
                                                    <option value="1">+1 OTM</option>
                                                    <option value="2">+2 OTM</option>
                                                    <option value="3">+3 OTM</option>
                                                    <option value="4">+4 OTM</option>
                                                    <option value="5">+5 OTM</option>
                                                    <option value="6">+6 OTM</option>
                                                    <option value="7">+7 OTM</option>
                                                    <option value="8">+8 OTM</option>
                                                    <option value="9">+9 OTM</option>
                                                    <option value="10">+10 OTM</option>
                                                </select>                
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                <select id="ddlOptionsSymbols" class="form-select" onchange="fnGetSelSymbolData(this.value);" placeholder="NSE Cash Symbols">
                                                    <option value=''>Select Option Symbol</option>
                                                </select>
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                <select id="ddlOptionsExpiry" class="form-select" onchange="//fnGetExpValByChdAPT(this.value);">
                                                </select>
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                <div class="input-group mb-3">
                                                    <button class="btn btn-danger" type="button" id="btnGetRatePE" onclick="fnGetCurrRateSettings('PE');"><i class="fa fa-chevron-down" aria-hidden="true"></i></button>
                                                    <input id="txtCurrentRate" type="number" min="1" class="form-control" placeholder="Current Rate" />
                                                    <button class="btn btn-success" type="button" id="btnGetRateCE" onclick="fnGetCurrRateSettings('CE');"><i class="fa fa-chevron-up" aria-hidden="true"></i></button>
                                                </div>
                                            </div>

                                            <div class="col-6 col-lg-3 col-md-6">
                                                Lot Size
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                Quantity
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                Stop Loss Points
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                Take Profit Points
                                            </div>

                                            <div class="col-6 col-lg-3 col-md-6">
                                                <input type="number" min="1" class="form-control" placeholder="Lot Size" id="txtOptionLotSize" value="1" />
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                <input type="number" min="1" class="form-control" placeholder="Quantity" id="txtOptionsQty" value="1" />
                                                
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                <input type="text" class="form-control" id="txtOptionsSL1" name="txtOptionsSL1" value="" placeholder="Stop Loss" />
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                <input type="text" class="form-control" id="txtOptionsTP1" name="txtOptionsTP1" value="" placeholder="Take Profit" />
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                <input type="hidden" id="hidJsonFileName" class="form-control" value="" placeholder="File Name" />
                                                <input type="hidden" id="hidSpotPrice" class="form-control" value="" placeholder="Spot Price" />
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                <input type="hidden" id="hidSearchSymbol" class="form-control" value="" placeholder="Search Symbol" />
                                                <input type="hidden" id="hidSpotOption" class="form-control" placeholder="Spot Option" value="" />
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                <input type="hidden" id="hidSegment" class="form-control" value="" placeholder="Segment" />
                                                <input type="hidden" id="hidMaxQty" class="form-control" placeholder="Max Quantity" value="" />
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                <input type="hidden" id="hidOptStrikeInterval" class="form-control" value="" placeholder="Strike Interval" />
                                                <input type="hidden" id="hidMaxPerOrdQty" class="form-control" placeholder="Max Order Quantity" value="" />
                                            </div>
                                            <hr/>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                <div class="d-grid gap-1">
                                                    <button class="btn btn-outline-danger" onclick="fnExecPlaceOrderTest('B', 'PE');//fnEmitTradeForAll('PE');" style="display: block;"><b>Buy PE for ALL</b></button>
                                                </div>
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                <div class="d-grid gap-1">
                                                    <button class="btn btn-outline-success" onclick="fnExecPlaceOrderTest('B', 'CE');//fnEmitTradeForAll('CE');" style="display: block;"><b>Buy CE for ALL</b></button>
                                                </div>
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                <div class="d-grid gap-1">
                                                    <button class="btn btn-outline-danger" onclick="fnInitiateManualOption('B', 'PE');"><b>BUY PE</b></button>
                                                </div>
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6">
                                                <div class="d-grid gap-1">
                                                    <button class="btn btn-outline-success" onclick="fnInitiateManualOption('B', 'CE');"><b>BUY CE</b></button>
                                                </div>
                                            </div>
                                            <hr/>
                                            <div class="col-6 col-lg-3 col-md-6" style="display:none;">
                                                <div class="d-grid gap-1">
                                                    <button class="btn btn-outline-danger" onclick="fnInitiateManualOptionBO('B', 'PE');"><b>BUY BO PE</b></button>
                                                </div>
                                            </div>
                                            <div class="col-6 col-lg-3 col-md-6" style="display:none;">
                                                <div class="d-grid gap-1">
                                                    <button class="btn btn-outline-success" onclick="fnInitiateManualOptionBO('B', 'CE');"><b>BUY BO CE</b></button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row" style="display:block;">
                                        <div class="col-12 col-lg-12 col-md-12">
                                            <input type="hidden" id="txtKotakSession" class="form-control" value="" placeholder="Kotak Session" />
                                            <input type="hidden" id="txtViewToken" class="form-control" value="" placeholder="View Token" />
                                            <input type="hidden" id="txtAccessToken" class="form-control" value="" placeholder="Access Token" />
                                            <input type="hidden" id="txtSubUserId" class="form-control" value="" placeholder="Sub / UserID" />
                                            <input type="hidden" id="txtSid" class="form-control" value="" placeholder="SID" />
                                            <input type="hidden" id="txtHsServerId" class="form-control" value="" placeholder="Hs Server ID" />
                                            <input type="hidden" id="hidLTP" class="form-control" value="" placeholder="LTP" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="row">
                                    <div class="col-6">
                                        <h4>Open Position(s)</h4>
                                    </div>
                                    <div class="col-4">

                                    </div>
                                    <div class="col-1">
                                        <span id="spnLossTrd" class="badge rounded-pill text-bg-danger" style="visibility: hidden;height: 30px; width: 30px;">&nbsp;
                                        </span>
                                    </div>
                                    <div class="col-1" style="text-align: right;">
                                        <a data-bs-toggle="collapse" href="#divOpenPosClps" role="button" aria-expanded="true" aria-controls="divOpenPosClps">
                                            <i class="fa fa-caret-square-o-down" aria-hidden="true" style="color: orangered;"></i>
                                        </a>
                                    </div>                                    
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="collapse show" id="divOpenPosClps">
                                    <div class="row">
                                        <div class="col-6 col-lg-6">
                                            <div class="row">
                                                <div class="col-6" style="font-size:14px; color:cornflowerblue">Entry Date Time</div>
                                                <div class="col-6" style="text-align:right; font-size:14px; white-space:nowrap; color:cornflowerblue" id="lblEntryDate">00-00-0000 00:00:00</div>
                                                <div class="col-4" style="font-weight:bold; white-space:nowrap; font-size:14px;" id="lblSymbol">SYMBOL NAME</div>
                                                <div class="col-2" style="font-weight:bold; white-space:nowrap; font-size:14px;" id="lblStrike">000000</div>
                                                <div class="col-1" style="font-weight:bold; white-space:nowrap; font-size:14px;" id="lblOptionType">OT</div>
                                                <div class="col-5" style="font-weight:bold; white-space:nowrap; font-size:14px; text-align:right;" id="lblExpiry">YYYY-MM-DD</div>
                                                <div class="col-12">&nbsp;</div>
                
                                                <div class="col-2" style="color:white; white-space:nowrap; font-size:14px; text-align: center;">LotSz</div>
                                                <div class="col-2" style="color:white; white-space:nowrap; font-size:14px; text-align: center;">QTY</div>
                                                <div class="col-3" style="color:green; white-space:nowrap; font-size:14px; text-align: center;" id="lblBuyPriceInd">BUY PRICE</div>
                                                <div class="col-3" style="color:red; white-space:nowrap; font-size:14px; text-align: center;" id="lblSellPriceInd">SELL PRICE</div>
                                                <div class="col-2" style="font-weight:bold; white-space:nowrap; font-size:14px; text-align: center;">P & L</div>
                
                                                <div class="col-2" style="color:white; white-space:nowrap; font-size:14px; text-align: center;" id="lblLotSize">0</div>
                                                <div class="col-2" style="color:white; white-space:nowrap; font-size:14px; text-align: center;" id="lblQty">0</div>
                                                <div class="col-3" style="color:green; white-space:nowrap; font-size:14px; text-align: center;" id="lblBuyPrice">0.00</div>
                                                <div class="col-3" style="color:red; white-space:nowrap; font-size:14px; text-align: center;" id="lblSellPrice">0.00</div>
                                                <div class="col-2" style="font-weight:bold; white-space:nowrap; font-size:14px; text-align: center;" id="lblProfitLoss">0.00</div>

                                                <div class="col-12">&nbsp;</div>

                                                <div class="col-3" style="font-weight:bold; white-space:nowrap; font-size:14px; text-align: center;">T-SL</div>
                                                <div class="col-3" style="font-weight:bold; white-space:nowrap; font-size:14px; text-align: center;">On SL</div>
                                                <div class="col-3" style="font-weight:bold; white-space:nowrap; font-size:14px; text-align: center;">On TP</div>
                                                <div class="col-3" style="font-weight:bold; white-space:nowrap; font-size:14px; text-align: center;">Capital:</div>
                
                                                <div class="col-3" style="text-align:center; color:orange; white-space:nowrap; text-align: center;" id="lblTrailSL">0.00</div>
                                                <div class="col-3" style="text-align:center; color:red; white-space:nowrap; text-align: center;" id="lblLossOnSL">0.00</div>
                                                <div class="col-3" style="text-align:center; color:green; white-space:nowrap; text-align: center;" id="lblProfitOnTP">0.00</div>
                                                <div class="col-3" id="lblCapital" style="font-weight:bold; white-space:nowrap; text-align: center;">0.00</div>

                                                <div class="col-12">&nbsp;</div>

                                                <div class="col-6">
                                                    <div class="d-grid gap-1">
                                                        <button id="btn50PerClose" class="btn btn-outline-primary" onclick="fnClose50PrctOptTrade();" disabled><b>Exit 50% QTY</b></button>
                                                    </div>
                                                </div>
                                                <div class="col-6">
                                                    <div class="d-grid gap-1">
                                                        <button class="btn btn-outline-danger" id="btnClosePosition" onclick="fnCloseOptTrade();"><b>CLOSE POSITION</b></button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-6 col-lg-6">
                                            <div class="row">
                                                <div class="col-4">
                                                    <div class="form-check form-switch fs-6" style="white-space: nowrap;">
                                                        <input class="form-check-input  me-0" type="checkbox" style="cursor: pointer" id="swtAutoChkPosition" name="swtAutoChkPosition" onchange="fnExecTradeTimer();" />
                                                        <label for="swtAutoChkPosition" style="cursor:pointer;">Auto Check Every</label>
                                                    </div>
                                                </div>
                                                <div class="col-3">
                                                    <input type="number" class="form-control" placeholder="Timer" id="txtTimeMS" value="5" maxlength="3" />
                                                </div>
                                                <div class="col-5">
                                                    
                                                </div>

                                                <div class="col-12">&nbsp;</div>

                                                <div class="col-12">
                                                    <select id="ddlTrailSLTP" class="form-select" onchange="fnSetDDLTrailSLTP(this);">
                                                        <option value=0 selected="true">NO SL or TP</option>
                                                        <option value=1>Strict SL or TP</option>
                                                        <option value=2>Trail By SL</option>
                                                        <option value=3>Trail SL After TP</option>
                                                        <option value=4>Exit 50% Qty on Profit</option>
                                                    </select>
                                                </div>
                                                <div class="col-12">
                                                    &nbsp;
                                                </div>
                                                <div class="col-4">
                                                    <input type="text" class="form-control" placeholder="SL" id="txtUpdStopLoss" />
                                                </div>
                                                <div class="col-4">
                                                    <input type="text" class="form-control" placeholder="TP" id="txtUpdTakeProfit" />
                                                </div>
                                                <div class="col-4">
                                                    <button class="btn btn-outline-info btn-block" id="btnUpdateSLTP" onclick="fnUpdateOptSLTP();"><b>UPDATE</b></button>
                                                </div>
                                                <div class="col-2">
                                                    
                                                </div>
                                                <div class="col-2">
                                                    <button class='btn btn-block btn-xl btn-outline-info font-bold mt-3' onclick="fnStartWS();">START</button>
                                                </div>
                                                <div class="col-2">
                                                    <button class='btn btn-block btn-xl btn-outline-info font-bold mt-3' onclick="fnRestartStreamOptPrc();//fnStopWS();">STOP</button>
                                                </div>
                                                <div class="col-2">
                                                    <button class='btn btn-block btn-xl btn-outline-info font-bold mt-3' onclick="resumeandpause('cp', '1');">Pause</button>
                                                </div>
                                                <div class="col-2">
                                                    <button class='btn btn-block btn-xl btn-outline-info font-bold mt-3' onclick="resumeandpause('cr', '1');">Resume</button>
                                                </div>
                                                <div class="col-2">
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="row">
                                    <div class="col-6">
                                        <h4>Orderbook</h4>
                                    </div>
                                    <div class="col-4">
                                    </div>
                                    <div class="col-1">
                                        <button class='nav-link' onclick="fnClearLocalStorageTemp();" role="tab" type="button">Clear All</button>
                                    </div>
                                    <div class="col-1" style="text-align: right;">
                                        <a data-bs-toggle="collapse" href="#divClosedPosClps" role="button" aria-expanded="false" aria-controls="divClosedPosClps">
                                            <i class="fa fa-caret-square-o-down" aria-hidden="true" style="color: orangered;"></i>
                                          </a>
                                    </div>                                    
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="collapse show" id="divClosedPosClps">
                                    <div class="container-fluid">
                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead>
                                                    <tr style="text-align:center;">
                                                        <!-- <th scope="col">TradeID</th> -->
                                                        <th scope="col" style="text-wrap: nowrap;">Date Time</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Symbol</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Expiry</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Strike</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Type</th>
                                                        <th scope="col" style="text-wrap: nowrap;">B or S</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Qty</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Buy Price</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Sell Price</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Charges</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Capital</th>
                                                        <!-- <th scope="col" style="text-wrap: nowrap;">P &amp; L</th> -->
                                                    </tr>
                                                    </thead>
                                                    <tbody id="divClsdOrderbook">

                                                    </tbody>
                                            </table>
                                        </div>
                                    </div>                    
                                </div>
                            </div>
                        </div>
                        <div class="card">
                            <div class="card-header">
                                <div class="row">
                                    <div class="col-6">
                                        <h4>Trade Book</h4>
                                    </div>
                                    <div class="col-3">

                                    </div>
                                    <div class="col-1">
                                        <i class="fa fa-refresh" aria-hidden="true" style="color: skyblue; cursor: pointer;" onclick="fnGetOrderBook();"></i>
                                    </div>
                                    <div class="col-1">
                                        <i class="fa fa-refresh" aria-hidden="true" style="color: skyblue; cursor: pointer;" onclick="fnGetTradeBook();"></i>
                                    </div>
                                    <div class="col-1" style="text-align: right;">
                                        <a data-bs-toggle="collapse" href="#divTradeBook" role="button" aria-expanded="true" aria-controls="divTradeBook">
                                            <i class="fa fa-caret-square-o-down" aria-hidden="true" style="color: orangered;"></i>
                                          </a>
                                    </div>                                    
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="collapse show" id="divTradeBook">
                                    <div class="container-fluid">
                                        <div class="table-responsive">
                                            <table class="table">
                                                <thead>
                                                    <tr style="text-align:center;">
                                                        <!-- <th scope="col">TradeID</th> -->
                                                        <th scope="col" style="text-wrap: nowrap;">Date Time</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Symbol</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Expiry</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Strike</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Type</th>
                                                        <th scope="col" style="text-wrap: nowrap;">B or S</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Qty</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Buy Price</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Sell Price</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Charges</th>
                                                        <th scope="col" style="text-wrap: nowrap;">Capital</th>
                                                        <!-- <th scope="col" style="text-wrap: nowrap;">P &amp; L</th> -->
                                                    </tr>
                                                    </thead>
                                                    <tbody id="divTodayTrades">
    
                                                    </tbody>
                                            </table>
                                        </div>
                                    </div>                    
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>
</div>

<%- include('partials/kotakSettings.ejs') %>

<script src="/js/kotakLive.js"></script>
<script src="/js/kotakSettings.js"></script>